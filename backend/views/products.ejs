<%- include('partials/header') %>

<div class="container">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="mb-4">Product Catalog</h1>
            
            <!-- Category Filter -->
            <div class="category-filter">
                <strong class="me-3">Filter by Category:</strong>
                <a href="/products" class="btn btn-sm <%= currentCategory === 'All' ? 'btn-primary' : 'btn-outline-primary' %>">All</a>
                <% categories.forEach(cat => { %>
                <a href="/products?category=<%= encodeURIComponent(cat) %>" class="btn btn-sm <%= currentCategory === cat ? 'btn-primary' : 'btn-outline-primary' %>"><%= cat %></a>
                <% }); %>
            </div>
        </div>
    </div>

    <% if (typeof error !== 'undefined' && error) { %>
    <div class="alert alert-danger">
        <%= error %>
    </div>
    <% } %>

    <% if (products && products.length > 0) { %>
    <div class="product-grid">
        <% products.forEach(product => { %>
        <div class="card">
            <% if (product.images && product.images.length > 0) { %>
            <img src="<%= product.images[0] %>" class="card-img-top" alt="<%= product.name %>" onerror="this.src='https://via.placeholder.com/300x250?text=No+Image'">
            <% } else { %>
            <img src="https://via.placeholder.com/300x250?text=No+Image" class="card-img-top" alt="<%= product.name %>">
            <% } %>
            <div class="card-body">
                <span class="badge bg-secondary mb-2"><%= product.category %></span>
                <h5 class="card-title"><%= product.name %></h5>
                <p class="text-muted mb-2"><strong>Fabric Type:</strong> <%= product.fabricType %></p>
                <p class="text-muted mb-2"><strong>GSM:</strong> <%= product.gsm %></p>
                <p class="text-muted mb-3"><strong>Size Range:</strong> <%= product.sizeRange %></p>
                <% if (product.description) { %>
                <p class="card-text"><%= product.description.substring(0, 100) %><% if (product.description.length > 100) { %>...<% } %></p>
                <% } %>
                <div class="mt-3">
                    <a href="/products/<%= product._id %>" class="btn btn-primary me-2">View Details</a>
                    <a href="/samples/request?productId=<%= product._id %>" class="btn btn-outline-primary">Request Sample</a>
                </div>
            </div>
        </div>
        <% }); %>
    </div>
    <% } else { %>
    <div class="alert alert-info">
        <h5>No products found</h5>
        <p>There are no products available in this category at the moment. Please check back later.</p>
    </div>
    <% } %>
</div>

<%- include('partials/footer') %>

