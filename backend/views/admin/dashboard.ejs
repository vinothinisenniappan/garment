<%- include('../partials/header') %>

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>Admin Dashboard</h1>
                <a href="/admin/logout" class="btn btn-outline-danger">
                    <i class="bi bi-box-arrow-right"></i> Logout
                </a>
            </div>
        </div>
    </div>

    <% if (typeof error !== 'undefined' && error) { %>
    <div class="alert alert-danger">
        <%= error %>
    </div>
    <% } %>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <h3><%= stats.totalProducts || 0 %></h3>
                <p>Total Products</p>
                <a href="/admin/products" class="btn btn-sm btn-primary">Manage</a>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <h3><%= stats.totalBuyers || 0 %></h3>
                <p>Buyer Inquiries</p>
                <a href="/admin/buyers" class="btn btn-sm btn-primary">View</a>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <h3><%= stats.totalSamples || 0 %></h3>
                <p>Sample Requests</p>
                <a href="/admin/samples" class="btn btn-sm btn-primary">Manage</a>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="stats-card">
                <h3><%= stats.pendingSamples || 0 %></h3>
                <p>Pending Samples</p>
                <a href="/admin/samples?status=Requested" class="btn btn-sm btn-warning">View</a>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Quick Actions</h5>
                </div>
                <div class="card-body">
                    <a href="/admin/products/add" class="btn btn-primary me-2 mb-2">
                        <i class="bi bi-plus-circle"></i> Add New Product
                    </a>
                    <a href="/admin/buyers" class="btn btn-secondary me-2 mb-2">
                        <i class="bi bi-people"></i> View Buyer Inquiries
                    </a>
                    <a href="/admin/samples" class="btn btn-info me-2 mb-2">
                        <i class="bi bi-box-seam"></i> Manage Sample Requests
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Recent Buyers -->
        <div class="col-lg-6 mb-4">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Recent Buyer Inquiries</h5>
                    <a href="/admin/buyers" class="btn btn-sm btn-outline-primary">View All</a>
                </div>
                <div class="card-body">
                    <% if (recentBuyers && recentBuyers.length > 0) { %>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Company</th>
                                    <th>Contact</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% recentBuyers.forEach(buyer => { %>
                                <tr>
                                    <td><%= buyer.companyName %></td>
                                    <td><%= buyer.email %></td>
                                    <td><span class="badge bg-secondary"><%= buyer.status %></span></td>
                                    <td><%= new Date(buyer.submittedAt).toLocaleDateString() %></td>
                                </tr>
                                <% }); %>
                            </tbody>
                        </table>
                    </div>
                    <% } else { %>
                    <p class="text-muted mb-0">No recent buyer inquiries</p>
                    <% } %>
                </div>
            </div>
        </div>

        <!-- Recent Sample Requests -->
        <div class="col-lg-6 mb-4">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Recent Sample Requests</h5>
                    <a href="/admin/samples" class="btn btn-sm btn-outline-primary">View All</a>
                </div>
                <div class="card-body">
                    <% if (recentSamples && recentSamples.length > 0) { %>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Buyer</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% recentSamples.forEach(sample => { %>
                                <tr>
                                    <td><%= sample.productId ? sample.productId.name : 'N/A' %></td>
                                    <td><%= sample.buyerEmail %></td>
                                    <td><span class="badge badge-status-<%= sample.status.toLowerCase().replace(' ', '-') %>"><%= sample.status %></span></td>
                                    <td><%= new Date(sample.requestedAt).toLocaleDateString() %></td>
                                </tr>
                                <% }); %>
                            </tbody>
                        </table>
                    </div>
                    <% } else { %>
                    <p class="text-muted mb-0">No recent sample requests</p>
                    <% } %>
                </div>
            </div>
        </div>
    </div>
</div>

<%- include('../partials/footer') %>

